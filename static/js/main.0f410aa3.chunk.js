(this["webpackJsonpfcav-mvp"]=this["webpackJsonpfcav-mvp"]||[]).push([[0],{135:function(e,t,a){e.exports=a.p+"static/media/nemac_logo_white.b9acf019.png"},136:function(e,t,a){e.exports=a.p+"static/media/nemac_logo_black.f0b63d98.png"},137:function(e,t,a){e.exports=a.p+"static/media/forwarn2-legend.e6734a0a.png"},173:function(e,t,a){e.exports=a(301)},301:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(19),o=a.n(l),i=(a(178),a(100)),c=a.n(i),s=a(132),u=a(11),m=a(3),p=a.n(m),g={juliandates:["001","009","017","025","033","041","049","057","065","073","081","089","097","105","113","121","129","137","145","153","161","169","177","185","193","201","209","217","225","233","241","249","257","265","273","281","289","297","305","313","321","329","337","345","353","361"],wms_template:function(e,t){return[{baseUrl:"https://fswms.nemac.org/forwarn_compare",options:{layers:"FW_".concat(e,"_1YR_FW2"),format:"image/png",transparent:!0,tileSize:2048,uppercase:!0,opacity:0},leafletLayer:""},{baseUrl:"https://fswms.nemac.org/forwarn_compare",options:{layers:"FW_".concat(e,"_ALC_FW2"),format:"image/png",transparent:!0,tileSize:2048,uppercase:!0,opacity:0},leafletLayer:""},{baseUrl:"https://fswms.nemac.org/forwarn_compare",options:{layers:"FW_".concat(e,"_3YR_FW2"),format:"image/png",transparent:!0,tileSize:2048,uppercase:!0,opacity:0},leafletLayer:""},{baseUrl:"https://fswms.nemac.org/forwarn_compare",options:{layers:"FW_".concat(e,"_5YR_FW2"),format:"image/png",transparent:!0,tileSize:2048,uppercase:!0,opacity:0},leafletLayer:""},{baseUrl:"https://fswms.nemac.org/forwarn_compare",options:{layers:"FW_".concat(e,"_MEDIAN_ALL_YEAR_FW2"),format:"image/png",transparent:!0,tileSize:2048,uppercase:!0,opacity:0},leafletLayer:""}][t]},baseLayers:[{name:"Streets",url:"https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibHVrZWpheSIsImEiOiJjazVoM3JwaTMwZXJiM2t0ZDZyZnF5bnN3In0.NQ71qNFEXZZzlOhYyWlIPg",attribution:"",layer:"",theme:"light"},{name:"Light",url:"https://api.mapbox.com/styles/v1/mapbox/light-v10/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibHVrZWpheSIsImEiOiJjazVoM3JwaTMwZXJiM2t0ZDZyZnF5bnN3In0.NQ71qNFEXZZzlOhYyWlIPg",attribution:"",layer:"",theme:"light"},{name:"Dark",url:"https://api.mapbox.com/styles/v1/mapbox/dark-v10/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibHVrZWpheSIsImEiOiJjazVoM3JwaTMwZXJiM2t0ZDZyZnF5bnN3In0.NQ71qNFEXZZzlOhYyWlIPg",attribution:"",layer:"",theme:"dark"},{name:"Outdoors",url:"https://api.mapbox.com/styles/v1/mapbox/outdoors-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibHVrZWpheSIsImEiOiJjazVoM3JwaTMwZXJiM2t0ZDZyZnF5bnN3In0.NQ71qNFEXZZzlOhYyWlIPg",attribution:"",layer:"",theme:"light"},{name:"Satellite",url:"https://api.mapbox.com/styles/v1/mapbox/satellite-v9/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibHVrZWpheSIsImEiOiJjazVoM3JwaTMwZXJiM2t0ZDZyZnF5bnN3In0.NQ71qNFEXZZzlOhYyWlIPg",attribution:"",layer:"",theme:"dark"}],productsList:["From Prior Year","Early Detect","From Prior 3-Year Max","From Prior 5-Year 90th Percentile","From All-Prior-Year Median"],themesList:["Dark","Light"]},f=a(333),d=a(343),h=a(336),b=a(342),y=a(338),v=a(135),E=a.n(v),O=a(136),x=a.n(O),j=a(137),I=a.n(j),k=a(341),w=a(346),L=a(350),D=a(348),_=a(24),S=a(344),Z=a(146),T=a(349),C=a(331),M=a(334),F=(a(144),a(101)),N=a.n(F),z=a(145),W=a.n(z),J=a(345),A=a(337);function Y(e,t){e=parseInt(e);var a=0,n=[0,31,59,90,120,151,181,212,243,273,304,334];(function(e){return e%4===0&&e%100!==0||e%400===0})(t)&&(n=[0,31,60,91,121,152,182,213,244,274,305,335]);for(var r=0;r<n.length;r++)e>n[r+1]&&(a=r+1);var l=e-n[a];return new Date(t,a,l)}function P(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=String(e.getFullYear()),n=String(e.getMonth()+1),r=String(e.getDate());n.length<2&&(n="0"+n),r.length<2&&(r="0"+r);return t?a+"-"+n+"-"+r:a+n+r}function R(e){for(var t,a=(t=e.getFullYear(),g.juliandates.map((function(e){return Y(parseInt(e)+7,t)}))),n=0;n<a.length;n++)if(a[n]>=e)return a[n];return Y(parseInt(g.juliandates[0],e.getFullYear()+1))}Date.prototype.isLeapYear=function(){var e=this.getFullYear();return 0==(3&e)&&(e%100!=0||e%400==0)},Date.prototype.getDOY=function(){var e=this.getMonth(),t=this.getDate(),a=[0,31,59,90,120,151,181,212,243,273,304,334][e]+t;return e>1&&this.isLeapYear()&&a++,a};var V=a(330),H=a(147),X=a(78),U={light:Object(H.a)({palette:{primary:{main:"#f5f5f5"},secondary:{main:"#222222"},error:{main:X.a.A400},background:{default:"#f5f5f5"},appBar:{main:"#556cd6",contrastText:"#222222"},nemacLogo:"./nemac_logo_black.png"}}),dark:Object(H.a)({palette:{type:"dark",primary:{main:"#26292C",light:"rgb(81, 91, 95)",dark:"rgb(26, 35, 39)",contrastText:"#ffffff"},secondary:{main:"#ffffff",light:"rgb(255, 197, 112)",dark:"rgb(200, 147, 89)",contrastText:"rgba(0, 0, 0, 0.87)"},appBar:{main:"#555555",contrastText:"#ffffff"},error:{main:X.a.A400},nemacLogo:"./nemac_logo_white.png"}})};var B=r.a.createContext({currentTheme:"dark",setTheme:null}),q=function(e){var t=e.children,a=localStorage.getItem("appTheme")||"dark",l=Object(n.useState)(a),o=Object(u.a)(l,2),i=o[0],c=o[1],s=function(e){return U[e]}(i),m={currentTheme:i,setTheme:function(e){localStorage.setItem("appTheme",e),c(e)}};return r.a.createElement(B.Provider,{value:m},r.a.createElement(V.a,{theme:s},t))},Q=(a(182),a(183),a(139)),G=(a(184),a(149)),K=a(143),$=a(23),ee=a(148);$.b.register(ee.a);var te=[35,-82];function ae(e,t){var a=Object(n.useState)(e),r=Object(u.a)(a,2),l=r[0],o=r[1];return Object(n.useDebugValue)("".concat(t,": ").concat(l)),[l,o]}var ne=document.getElementById("app");o.a.render(r.a.createElement(q,null,r.a.createElement((function(e){function t(e){return function(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){t.current=e})),t.current}(e)!==e}var a=Object(n.useContext)(B).setTheme,l=ae(!0),o=Object(u.a)(l,2),i=o[0],m=o[1],v=Object(C.a)({root:{width:300},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{position:"absolute",color:"white",width:"100%",height:"45vh",background:"rgb(26, 35, 39)",boxShadow:24,padding:4}})(),O=ae(!1),j=Object(u.a)(O,2),F=j[0],z=(j[1],ae(!1,"GraphOn")),Y=Object(u.a)(z,2),V=Y[0],H=Y[1],X=ae("90vh","mapHeight"),U=Object(u.a)(X,2),q=U[0],$=(U[1],ae("","map")),ee=Object(u.a)($,2),ne=ee[0],re=ee[1],le=function(){H(!V);var e=document.querySelector(".mapContainer");V?e.style.setProperty("height","90vh"):e.style.setProperty("height","45vh"),ne.invalidateSize()},oe=ae({labels:["1","2","3","4","5","6"],coordinates:[0,0],datasets:[{label:"# of Votes",data:[],fill:!1,backgroundColor:"rgb(3, 237, 96)",borderColor:"rgba(3, 237, 96, 0.8)",xAxisID:"xAxis"}]},"MODIS CHART DATA"),ie=Object(u.a)(oe,2),ce=ie[0],se=ie[1],ue=ae({maintainAspectRatio:!1,plugins:{annotation:{annotations:[{drawTime:"afterDatasetsDraw",type:"line",mode:"vertical",scaleID:"xAxis",value:5,borderWidth:5,borderColor:"red",label:{content:"TODAY",enabled:!0,position:"top"}}]}},scales:{yAxes:[{ticks:{beginAtZero:!0,steps:10,stepValue:5,max:100,fontColor:"white"}}]}},"MODIS CHART CONFIG"),me=Object(u.a)(ue,2),pe=me[0],ge=(me[1],Object(n.useState)(null)),fe=Object(u.a)(ge,2),de=(fe[0],fe[1],Object(n.useState)(!1)),he=Object(u.a)(de,2),be=(he[0],he[1],Object(n.useState)([])),ye=Object(u.a)(be,2),ve=(ye[0],ye[1],ae(new Date("2020-01-16"),"startDate")),Ee=Object(u.a)(ve,2),Oe=Ee[0],xe=Ee[1],je=ae(new Date("2021-02-17"),"endDate"),Ie=Object(u.a)(je,2),ke=Ie[0],we=Ie[1],Le=ae(0,"dateRangeIndex"),De=Object(u.a)(Le,2),_e=De[0],Se=De[1],Ze=t(_e),Te=g.baseLayers,Ce=ae(2,"basemapIndex"),Me=Object(u.a)(Ce,2),Fe=Me[0],Ne=Me[1],ze=Object(n.useRef)(),We=t(Fe),Je=ae(0,"productIndex"),Ae=Object(u.a)(Je,2),Ye=Ae[0],Pe=Ae[1],Re=t(Ye),Ve=g.productsList,He=ae(pt(Oe,ke,Ye),"fullWMSLayers"),Xe=Object(u.a)(He,2),Ue=Xe[0],Be=Xe[1],qe=g.themesList,Qe=ae(0,"themeIndex"),Ge=Object(u.a)(Qe,2),Ke=Ge[0],$e=Ge[1],et=ae([],"mapControls"),tt=Object(u.a)(et,2),at=(tt[0],tt[1],ae(!0,"initialrender")),nt=Object(u.a)(at,2),rt=nt[0],lt=nt[1],ot=function(e){var t=e.getDate().toString();t.length<2&&(t="0"+t);var a=(e.getMonth()+1).toString();a.length<2&&(a="0"+a),xe(e);var n=pt(e,ke,Ye);Be(n),Se(0)},it=function(e){var t=e.getDate().toString();t.length<2&&(t="0"+t);var a=(e.getMonth()+1).toString();a.length<2&&(a="0"+a),we(e);var n=pt(Oe,e,Ye);Be(n),Se(0)},ct=function(e){var t=e.target.value;Ne(t)},st=function(e){var t=e.target.value;$e(t)},ut=function(e){var t=e.target.value;Pe(t);var a=pt(Oe,ke,t);Be(a),Se(0)},mt=function(e,t){console.log("slider change"),console.log("slider value is "+String(t)),t!==_e&&Se(t)};function pt(e,t,a){var n=[],r=R(e);for(console.log("tempdate: "+r);r<=t;){var l=P(r),o=g.wms_template(l,a);o.leafletLayer=p.a.tileLayer.wms(o.baseUrl,o.options),o.date=r,n.push(o),r.setDate(r.getDate()+1),r=R(r)}return n}function gt(e,t){return ft.apply(this,arguments)}function ft(){return(ft=Object(s.a)(c.a.mark((function e(t,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:dt(t,a).then((function(e){if(null!=e.mugl){console.log("data fetch success"),console.log(e);var n=ht(e.mugl.data.values),r={labels:bt(e.mugl.data.values),coordinates:[t,a],datasets:[{label:e.mugl.verticalaxis.title,data:n,fill:!1,backgroundColor:ce.datasets[0].backgroundColor,borderColor:ce.datasets[0].borderColor,xAxisID:"xAxis"}]};se(r)}else console.log("invalid coordinates selected, do nothing")}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(e,t){return fetch("https://fcav-ndvi-dev.nemac.org/tsmugl_product.cgi?args=CONUS_NDVI,"+e+","+t).then((function(e){return e.text()})).then((function(e){return Object(K.parse)(e)})).catch((function(e){console.log("invalid coords")}))}function ht(e){for(var t=e.split("\n"),a=0;a<t.length;a++){var n=t[a];n=n.substr(9,11),t[a]=parseInt(n),t[a]<0&&(t[a]=0)}return t}function bt(e){for(var t=e.split("\n"),a=0;a<t.length;a++){var n=t[a],r=(n=n.substr(0,8)).substr(0,4),l=n.substr(4,2),o=n.substr(6,2);n=r+"/"+l+"/"+o,t[a]=n}return t}function yt(e){return r.a.createElement(M.a,{letiant:"contained",color:"secondary",className:v.button,startIcon:V?r.a.createElement(N.a,null):r.a.createElement(W.a,null),onClick:le},V?"Hide Graph":"Show Graph")}var vt=function(){return r.a.createElement(J.a,{className:v.paper},r.a.createElement(A.a,{variant:"h4",align:"center"}," MODIS NDVI ",ce.coordinates[0]+", "+ce.coordinates[1]," "),r.a.createElement("div",{style:{height:"35vh"}},r.a.createElement(G.a,{data:ce,options:pe,plugins:[]})))};function Et(){return r.a.createElement(_.a,{utils:Z.a},r.a.createElement(S.a,{style:{marginRight:16},disableToolbar:!0,letiant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-inline",label:"Start Date",value:Oe,onChange:ot,KeyboardButtonProps:{"aria-label":"change date"}}),r.a.createElement("div",{className:v.root,style:{marginRight:16,marginTop:16}},r.a.createElement(T.a,{color:"secondary",defaultValue:_e,"aria-labelledby":"discrete-slider",valueLabelDisplay:"auto",step:1,marks:!0,min:0,max:Ue.length-1,onChangeCommitted:mt})),r.a.createElement(S.a,{style:{marginRight:16},disableToolbar:!0,letiant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-inline",label:"End Date",value:ke,onChange:it,KeyboardButtonProps:{"aria-label":"change date"}}))}function Ot(){return r.a.createElement(k.a,{letiant:"outlined",style:{marginRight:16}},r.a.createElement(D.a,{shrink:!0,id:"demo-simple-select-placeholder-label-label"},"Basemap"),r.a.createElement(w.a,{labelId:"fcav-basemap-select-label",id:"fcav-basemap-select",value:Fe,onChange:ct,label:"Product"},Te.map((function(e,t){return r.a.createElement(L.a,{key:t,value:t},e.name)}))))}function xt(){return Object(n.useEffect)((function(){var e=qe[Ke];e=e.toLowerCase(),console.log("chosen theme: "+e),a(e),m("dark"===e)}),[Ke]),r.a.createElement(k.a,{letiant:"outlined",style:{marginRight:16}},r.a.createElement(D.a,{shrink:!0,id:"demo-simple-select-placeholder-label-label"},"Theme"),r.a.createElement(w.a,{labelId:"fcav-theme-select-label",id:"fcav-theme-select",value:Ke,onChange:st,label:"Theme"},qe.map((function(e,t){return r.a.createElement(L.a,{key:t,value:t},e)}))))}function jt(){return r.a.createElement(k.a,{letiant:"outlined",style:{marginRight:16}},r.a.createElement(D.a,{shrink:!0,id:"demo-simple-select-placeholder-label-label"},"Product"),r.a.createElement(w.a,{labelId:"fcav-product-select-label",id:"fcav-product-select",value:Ye,onChange:ut,label:"Product"},Ve.map((function(e,t){return r.a.createElement(L.a,{key:t,value:t},e)}))))}return r.a.createElement("div",null,r.a.createElement(h.a,{container:!0},r.a.createElement((function(){return r.a.createElement(h.a,{item:!0,xs:12},r.a.createElement(b.a,{position:"static",style:{zIndex:"0",flexWrap:"flex",flexDirection:"column"}},r.a.createElement(y.a,null,r.a.createElement("img",{src:i?E.a:x.a,width:"150",alt:"your mom"}),r.a.createElement(Ot,null),r.a.createElement(Et,null),r.a.createElement(jt,null),r.a.createElement(xt,null),r.a.createElement(yt,null))))}),null),r.a.createElement(h.a,{item:!0,xs:12},r.a.createElement(d.a,{className:"mapContainer",whenCreated:function(e){e.on("click",(function(e){var t=e.latlng,a=t.lat;gt(t.lng,a)}))},center:te,zoom:13,style:{height:q,display:"flex"}},r.a.createElement((function(){var e=Object(Q.geosearch)(),t=Object(f.a)();re(t);var a=function(){console.log("Clearing map..."),t.eachLayer((function(e){if(ze.current===e)return console.log("Skipping basemap layer..."),void console.log(ze.current);console.log("Removing layer: "),console.log(e),t.removeLayer(e)}))};if(Object(n.useEffect)((function(){if(We||rt){console.log("basemap change hook"),null!=ze.current&&t.removeLayer(ze.current);ze.current;var e=Te[Fe],a=new p.a.tileLayer(e.url,{opacity:0,attribution:e.attribution});t.addLayer(a),a.bringToBack(),a.setOpacity(1),ze.current=a}if(We&&!rt)return function(){}}),[We,Fe]),Object(n.useEffect)((function(){(Re||rt)&&(console.log("Product change hook"),a())}),[Re,Ye]),Object(n.useEffect)((function(){if(Ze||rt||Re){console.log("date range index hook"),a();var e=Ue[_e];if(console.log("new layer: "),console.log(e),t.hasLayer(e.leafletLayer)||(console.log("adding layer to the map..."),t.addLayer(e.leafletLayer)),e.leafletLayer.bringToFront(),e.leafletLayer.setOpacity(1),F){var n=_e+1===Ue.length?0:_e+1,r=setTimeout((function(){Se(n)}),1e4);return function(){r&&clearTimeout(r)}}}}),[Ze,_e,Ye]),Object(n.useEffect)((function(){F&&Ue.forEach((function(e){e.leafletLayer.setOpacity(0),t.hasLayer(e.leafletLayer)||t.addLayer(e.leafletLayer)}))}),[F]),rt){e.addTo(t);var r=p.a.control({position:"bottomright"});r.onAdd=function(){var e=p.a.DomUtil.create("div","info legend");return e.innerHTML="<img src="+I.a+' width="128.5px" height="210.5px">',e},r.addTo(t),p.a.Control.loading({separate:!0}).addTo(t)}return rt&&lt(!1),null}),null))),r.a.createElement((function(){return r.a.createElement(h.a,{item:!0,xs:12},V?r.a.createElement(vt,null):null)}),null)))}),null),","),ne)}},[[173,1,2]]]);
//# sourceMappingURL=main.0f410aa3.chunk.js.map